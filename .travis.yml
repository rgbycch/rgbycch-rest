language: ruby
rvm:
  - 2.3.1

bundler_args: --without development

before_script:
  - cp config/secrets.template.yml config/secrets.yml

script:
  - rm -f db/*.sqlite3
  - RAILS_ENV=test bundle exec rake db:setup --trace
  - RAILS_ENV=test bundle exec rake db:reset
  - RAILS_ENV=test bundle exec rake db:migrate
  - RAILS_ENV=test bundle exec rspec spec
